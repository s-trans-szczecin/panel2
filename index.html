<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <title>Panel Transport</title>

  <!-- ðŸ”´ FIREBASE SDK (WERSJA COMPAT â€“ NAJPROSTSZA) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <!-- ðŸ”´ TWOJA KONFIGURACJA -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAjkKqpO-3_Ltp3Jofc4oDu81Y5pb2IsQk",
      authDomain: "fir-trans-10591.firebaseapp.com",
      databaseURL: "https://fir-trans-10591-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "fir-trans-10591",
      storageBucket: "fir-trans-10591.appspot.com",
      messagingSenderId: "454345201943",
      appId: "1:454345201943:web:panel"
    };

    // âœ… INICJALIZACJA
    firebase.initializeApp(firebaseConfig);

    // âœ… REFERENCJE
    const auth = firebase.auth();
    const db = firebase.database();

    console.log("Firebase OK");
  </script>
</head>


  <script>
    /********** TU WKLEJ KLUCZE KONFIGURACYJNE FIREBASE **********/
    const firebaseConfig = {
      apiKey: "TWÃ“J_API_KEY",
      authDomain: "TWÃ“J_PROJECT_ID.firebaseapp.com",
      projectId: "TWÃ“J_PROJECT_ID",
      storageBucket: "TWÃ“J_PROJECT_ID.appspot.com",
      messagingSenderId: "TWÃ“J_MESSAGING_SENDER_ID",
      appId: "TWÃ“J_APP_ID"
    };

    // Inicjalizacja Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
	
	
	
	  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAjkKqpO-3_Ltp3Jofc4oDu81Y5pb2IsQk",
      authDomain: "fir-trans-10591.firebaseapp.com",
      databaseURL: "https://fir-trans-10591-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "fir-trans-10591",
      storageBucket: "fir-trans-10591.appspot.com",
      messagingSenderId: "454345201943",
      appId: "1:454345201943:web:panel"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();
  </script>
</head>
<body>
    /**************************************************************/

    let currentUser = null;

    // Funkcja pokazujÄ…ca animowane logo przez 3 sekundy
    function showLogo() {
      const logoScreen = document.getElementById("logoScreen");
      logoScreen.style.display = "block";
      setTimeout(() => {
        logoScreen.style.display = "none";
        showMap();
      }, 3000);
    }

    // Funkcja pokazujÄ…ca mapÄ™
    function showMap() {
      const mapScreen = document.getElementById("mapScreen");
      mapScreen.style.display = "block";

      // inicjalizacja mapy (caÅ‚y Å›wiat)
      const map = L.map('map').setView([20, 0], 2);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      // po 3 sekundach pokaz logowanie
      setTimeout(() => {
        document.getElementById("mapScreen").style.display = "none";
        document.getElementById("login-container").style.display = "block";
      }, 3000);
    }

    // Funkcja logowania
    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          currentUser = userCredential.user;
          document.getElementById("login-container").style.display = "none";
          document.getElementById("panel-container").style.display = "block";
          loadOrders();
        })
        .catch((error) => {
          document.getElementById("loginError").innerText = error.message;
        });
    }

    // Funkcja Å‚adowania zleceÅ„
    function loadOrders() {
      const table = document.getElementById("ordersTable");
      table.innerHTML = `
        <tr>
          <th>ID</th>
          <th>TytuÅ‚</th>
          <th>Status</th>
          <th>Kierowca</th>
          <th>Akcje</th>
        </tr>
      `;

      db.collection("orders").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();
          const row = table.insertRow();
          row.insertCell(0).innerText = doc.id;
          row.insertCell(1).innerText = data.title;
          row.insertCell(2).innerText = data.status;
          row.insertCell(3).innerText = data.driverId || "-";

          const actionCell = row.insertCell(4);

          // Przypisz 001
          const btn001 = document.createElement("button");
          btn001.innerText = "Przypisz 001";
          btn001.onclick = () => {
            db.collection("orders").doc(doc.id).update({ driverId: "001" });
            loadOrders();
          };
          actionCell.appendChild(btn001);

          // Przypisz 002
          const btn002 = document.createElement("button");
          btn002.innerText = "Przypisz 002";
          btn002.onclick = () => {
            db.collection("orders").doc(doc.id).update({ driverId: "002" });
            loadOrders();
          };
          actionCell.appendChild(btn002);

          // ZmieÅ„ status
          const statusBtn = document.createElement("button");
          statusBtn.innerText = "Next Status";
          statusBtn.onclick = () => {
            const nextStatus = data.status === "nowe" ? "w trasie" : "zakoÅ„czone";
            db.collection("orders").doc(doc.id).update({ status: nextStatus });
            loadOrders();
          };
          actionCell.appendChild(statusBtn);
        });
      });
    }

    // Funkcja tworzenia nowego zlecenia
    function createNewOrder() {
      const title = prompt("TytuÅ‚ zlecenia:");
      const pickup = prompt("Adres odbioru:");
      const delivery = prompt("Adres dostawy:");
      if(title && pickup && delivery){
        db.collection("orders").add({
          title: title,
          status: "nowe",
          driverId: "",
          pickup: pickup,
          delivery: delivery,
          notes: ""
        }).then(() => loadOrders());
      }
    }

    window.onload = showLogo;
  </script>
</head>

<body>
  <!-- EKRAN LOGO -->
  <div id="logoScreen">
    <h1 style="font-size:50px; animation: fadeIn 3s infinite;">LOGO ANIMOWANE</h1>
  </div>

  <!-- EKRAN MAPY -->
  <div id="mapScreen">
    <h2>Mapa Åšwiata</h2>
    <div id="map"></div>
  </div>

  <!-- LOGOWANIE -->
  <div id="login-container">
    <h2>Logowanie</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="HasÅ‚o">
    <button id="loginBtn" onclick="login()">Zaloguj</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <!-- PANEL PO LOGOWANIU -->
  <div id="panel-container">
    <h2>Panel ZleceÅ„</h2>
    <button id="newOrderBtn" onclick="createNewOrder()">Nowe Zlecenie</button>
    <table id="ordersTable"></table>
  </div>

  <style>
    @keyframes fadeIn {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }
  </style>
</body>
</html>
